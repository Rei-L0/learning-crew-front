<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>스터디 참석자 명단</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- 헤더 섹션 -->
    <div class="header-image-container">
      <img src="assets/images/분석결과.jpg" alt="배경 이미지" />
      <h2>스터디 참석자 명단</h2>
    </div>

    <!-- 엑셀 다운로드 버튼 -->
    <div style="text-align: right; margin: 30px auto 10px; max-width: 65%;">
      <button id="downloadExcelBtn" class="upload-button" style="display: inline-flex; align-items: center; gap: 8px;">
        <i class="bi bi-file-earmark-excel" style="font-size: 1.2rem;"></i>
        엑셀 다운로드
      </button>
    </div>

    <!-- 테이블 섹션 -->
    <div id="boardContainer" style="margin-top: 10px;">
      <table class="board-table">
        <thead>
          <tr>
            <th>순번</th>
            <th>캠퍼스</th>
            <th>반</th>
            <th>이름</th>
            <th>등록일시</th>
          </tr>
        </thead>
        <tbody id="attendance-tbody">
          <!-- JS로 채워짐 -->
          <tr class="loading-row">
            <td colspan="5">명단을 불러오는 중입니다...</td>
          </tr>
        </tbody>
      </table>
      
      <!-- 페이지네이션 컨트롤 -->
      <div id="paginationControls" style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding: 15px; background-color: #f9f9f9;">
        <button id="prevPageBtn" class="upload-button" style="padding: 8px 16px;">
          <i class="bi bi-chevron-left"></i> 이전
        </button>
        <div id="pageInfo" style="font-size: 0.95rem; color: #333;">
          <!-- JS로 채워짐: 페이지 1 / 10 (총 500개) -->
        </div>
        <button id="nextPageBtn" class="upload-button" style="padding: 8px 16px;">
          다음 <i class="bi bi-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- 네비게이션 버튼 -->
    <div style="display: flex; gap: 10px; justify-content: center; margin: 20px auto; max-width: 600px;">
      <a href="index.html" class="button-link" style="background-color: #6c757d;">파일 업로드로 이동</a>
      <a href="board.html" class="button-link">게시판으로 이동</a>
    </div>

    <!-- SheetJS library for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <script src="config.js"></script>
    <script src="attendance.js"></script>
  </body>
</html>
